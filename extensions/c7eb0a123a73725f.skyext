const message = require('message');
const command = require('command');

const choices = ['rock', 'paper', 'scissors'];
const emojis = { rock: 'ğŸª¨', paper: 'ğŸ“„', scissors: 'âœ‚ï¸' };
const suffix = command.suffix.toLowerCase().trim();

// Parse user choice
let userChoice = null;
for (const c of choices) {
	if (suffix.startsWith(c)) {
		userChoice = c;
		break;
	}
}

if (!userChoice) {
	message.reply({
		embeds: [{
			title: 'âœ‚ï¸ Rock Paper Scissors',
			description: 'Usage: `' + command.prefix + command.key + ' <rock|paper|scissors>`\n\n' +
				'ğŸª¨ **Rock** beats Scissors\n' +
				'ğŸ“„ **Paper** beats Rock\n' +
				'âœ‚ï¸ **Scissors** beats Paper',
			color: 0x9b59b6
		}]
	});
} else {
	// Bot makes choice
	const botChoice = choices[Math.floor(Math.random() * 3)];
	
	let result, color;
	if (userChoice === botChoice) {
		result = "It's a tie! ğŸ¤";
		color = 0xf39c12;
	} else if (
		(userChoice === 'rock' && botChoice === 'scissors') ||
		(userChoice === 'paper' && botChoice === 'rock') ||
		(userChoice === 'scissors' && botChoice === 'paper')
	) {
		result = 'You win! ğŸ‰';
		color = 0x2ecc71;
	} else {
		result = 'You lose! ğŸ˜¢';
		color = 0xe74c3c;
	}
	
	message.reply({
		embeds: [{
			title: 'âœ‚ï¸ Rock Paper Scissors',
			description: 
				'**You:** ' + emojis[userChoice] + ' ' + userChoice + '\n' +
				'**Bot:** ' + emojis[botChoice] + ' ' + botChoice + '\n\n' +
				'**' + result + '**',
			color: color
		}]
	});
}