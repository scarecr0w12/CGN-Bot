<aside class="menu" style="position: relative;">
	<div class="is-flex is-justify-content-end mb-2">
		<button class="button is-small is-ghost" id="sidebar-toggle" title="Toggle Sidebar">
			<span class="icon"><i class="fa fa-bars"></i></span>
		</button>
	</div>

	<ul class="menu-list">
		<li>
			<% if(currentPage === `/dashboard/${serverData.id}/overview`) { %>
				<%- include('../partials/admin-sudo.ejs') %>
				<a class="is-active" href="#" data-tooltip="Overview">
					<span class="icon"><i class="fa fa-dashboard"></i></span>
					<span>Overview</span>
				</a>
			<% } else { %>
				<a href="/dashboard/<%= serverData.id %>/overview" data-tooltip="Overview">
					<span class="icon"><i class="fa fa-dashboard"></i></span>
					<span>Overview</span>
				</a>
			<% } %>
		</li>
	</ul>
	<p class="menu-label" data-tooltip="Commands">
        <span class="icon is-small">
            <i class="fa fa-cogs"></i>
        </span>
		<span>Commands</span>
	</p>
	<ul class="menu-list">
		<li>
			<% if(currentPage === `/dashboard/${serverData.id}/commands/command-options`) { %>
            <%- include('../partials/admin-sudo.ejs') %>
			<a class="is-active" href="#" data-tooltip="Command Options">
				<span class="icon"><i class="fa fa-sliders"></i></span>
				<span>Command Options</span>
			</a>
			<% } else { %>
				<a href="/dashboard/<%= serverData.id %>/commands/command-options" data-tooltip="Command Options">
					<span class="icon"><i class="fa fa-sliders"></i></span>
					<span>Command Options</span>
				</a>
			<% } %>
			<% if ([`/dashboard/${serverData.id}/commands/command-list`, `/dashboard/${serverData.id}/commands/rss-feeds`, `/dashboard/${serverData.id}/commands/streamers`, `/dashboard/${serverData.id}/commands/tags`, `/dashboard/${serverData.id}/commands/auto-translation`, `/dashboard/${serverData.id}/commands/trivia-sets`].includes(currentPage)) { %>
            <%- include('../partials/admin-sudo.ejs') %>
			<a class="<%= ([`/dashboard/${serverData.id}/commands/command-list`, `/dashboard/${serverData.id}/commands/rss-feeds`, `/dashboard/${serverData.id}/commands/streamers`, `/dashboard/${serverData.id}/commands/tags`, `/dashboard/${serverData.id}/commands/auto-translation`, `/dashboard/${serverData.id}/commands/trivia-sets`].includes(currentPage) || currentPage === `/dashboard/${serverData.id}/commands/command-list`) ? 'is-active' : '' %>" href="<%= currentPage === `/dashboard/${serverData.id}/commands/command-list` ? '#' : (`/dashboard/${serverData.id}/commands/command-list`) %>" data-tooltip="Command List">
				<span class="icon"><i class="fa fa-list"></i></span>
				<span>Command List</span>
			</a>
				<ul>
					<li>
						<% if (currentPage === `/dashboard/${serverData.id}/commands/rss-feeds`) { %>
							<a class="is-active" href="#" data-tooltip="RSS Feeds">
								<span class="icon"><i class="fa fa-rss"></i></span>
								<span>RSS Feeds</span>
							</a>
						<% } else { %>
							<a href="/dashboard/<%= serverData.id %>/commands/rss-feeds" data-tooltip="RSS Feeds">
								<span class="icon"><i class="fa fa-rss"></i></span>
								<span>RSS Feeds</span>
							</a>
						<% } %>
					</li>
					<li>
						<% if (currentPage === `/dashboard/${serverData.id}/commands/streamers`) { %>
								<a class="is-active" href="#" data-tooltip="Streamers">
									<span class="icon"><i class="fa fa-twitch"></i></span>
									<span>Streamers</span>
								</a>
							<% } else { %>
								<a href="/dashboard/<%= serverData.id %>/commands/streamers" data-tooltip="Streamers">
									<span class="icon"><i class="fa fa-twitch"></i></span>
									<span>Streamers</span>
								</a>
							<% } %>
					</li>
					<li>
						<% if (currentPage === `/dashboard/${serverData.id}/commands/tags`) { %>
								<a class="is-active" href="#" data-tooltip="Tags">
									<span class="icon"><i class="fa fa-tags"></i></span>
									<span>Tags</span>
								</a>
							<% } else { %>
								<a href="/dashboard/<%= serverData.id %>/commands/tags" data-tooltip="Tags">
									<span class="icon"><i class="fa fa-tags"></i></span>
									<span>Tags</span>
								</a>
							<% } %>
					</li>
					<li>
						<% if (currentPage === `/dashboard/${serverData.id}/commands/auto-translation`) { %>
								<a class="is-active" href="#" data-tooltip="Auto Translation">
									<span class="icon"><i class="fa fa-language"></i></span>
									<span>Auto Translation</span>
								</a>
							<% } else { %>
								<a href="/dashboard/<%= serverData.id %>/commands/auto-translation" data-tooltip="Auto Translation">
									<span class="icon"><i class="fa fa-language"></i></span>
									<span>Auto Translation</span>
								</a>
							<% } %>
					</li>
					<% if (configData.commands.trivia && configData.commands.trivia.isEnabled) { %>
						<li>
							<% if (currentPage === `/dashboard/${serverData.id}/commands/trivia-sets`) { %>
								<a class="is-active" href="#" data-tooltip="Trivia Sets">
									<span class="icon"><i class="fa fa-question-circle"></i></span>
									<span>Trivia Sets</span>
								</a>
							<% } else { %>
								<a href="/dashboard/<%= serverData.id %>/commands/trivia-sets" data-tooltip="Trivia Sets">
									<span class="icon"><i class="fa fa-question-circle"></i></span>
									<span>Trivia Sets</span>
								</a>
							<% } %>
						</li>
					<% } %>
				</ul>
			<% } else { %>
				<a href="/dashboard/<%= serverData.id %>/commands/command-list" data-tooltip="Command List">
					<span class="icon"><i class="fa fa-list"></i></span>
					<span>Command List &#9662;</span>
				</a>
			<% } %>
			<% if (currentPage === `/dashboard/${serverData.id}/commands/api-keys`) { %>
            <%- include('../partials/admin-sudo.ejs') %>
			<a class="is-active" href="#" data-tooltip="API Keys">
				<span class="icon"><i class="fa fa-key"></i></span>
				<span>API Keys</span>
			</a>
			<% } else { %>
				<a href="/dashboard/<%= serverData.id %>/commands/api-keys" data-tooltip="API Keys">
					<span class="icon"><i class="fa fa-key"></i></span>
					<span>API Keys</span>
				</a>
			<% } %>
			<% if (currentPage === `/dashboard/${serverData.id}/commands/tag-reaction`) { %>
            <%- include('../partials/admin-sudo.ejs') %>
			<a class="is-active" href="#" data-tooltip="Tag Reaction">
				<span class="icon"><i class="fa fa-hashtag"></i></span>
				<span>Tag Reaction</span>
			</a>
			<% } else { %>
				<a href="/dashboard/<%= serverData.id %>/commands/tag-reaction" data-tooltip="Tag Reaction">
					<span class="icon"><i class="fa fa-hashtag"></i></span>
					<span>Tag Reaction</span>
				</a>
			<% } %>
		</li>
	</ul>
	<p class="menu-label" data-tooltip="Stats & Points">
        <span class="icon is-small">
            <i class="fa fa-star"></i>
        </span>
        <span>Stats &amp; Points</span>
	</p>
	<ul class="menu-list">
		<li>
			<% if (currentPage === `/dashboard/${serverData.id}/stats-points/stats-collection`) { %>
            <%- include('../partials/admin-sudo.ejs') %>
			<a class="is-active" href="#" data-tooltip="Stats Collection">
				<span class="icon"><i class="fa fa-bar-chart"></i></span>
				<span>Stats Collection</span>
			</a>
			<% } else { %>
				<a href="/dashboard/<%= serverData.id %>/stats-points/stats-collection" data-tooltip="Stats Collection">
					<span class="icon"><i class="fa fa-bar-chart"></i></span>
					<span>Stats Collection</span>
				</a>
			<% } %>
			<% if (currentPage === `/dashboard/${serverData.id}/stats-points/ranks`) { %>
            <%- include('../partials/admin-sudo.ejs') %>
			<a class="is-active" href="#" data-tooltip="Ranks">
				<span class="icon"><i class="fa fa-trophy"></i></span>
				<span>Ranks</span>
			</a>
			<% } else { %>
				<a href="/dashboard/<%= serverData.id %>/stats-points/ranks" data-tooltip="Ranks">
					<span class="icon"><i class="fa fa-trophy"></i></span>
					<span>Ranks</span>
				</a>
			<% } %>
			<% if (currentPage === `/dashboard/${serverData.id}/stats-points/skynet-points`) { %>
            <%- include('../partials/admin-sudo.ejs') %>
			<a class="is-active" href="#" data-tooltip="SkynetPoints">
				<span class="icon"><i class="fa fa-diamond"></i></span>
				<span>SkynetPoints</span>
			</a>
			<% } else { %>
				<a href="/dashboard/<%= serverData.id %>/stats-points/skynet-points" data-tooltip="SkynetPoints">
					<span class="icon"><i class="fa fa-diamond"></i></span>
					<span>SkynetPoints</span>
				</a>
			<% } %>
		</li>
	</ul>
	<p class="menu-label" data-tooltip="Administration">
        <span class="icon is-small">
            <i class="fa fa-wrench"></i>
        </span>
        <span>Administration</span>
	</p>
	<ul class="menu-list">
		<li>
			<% if (currentPage === `/dashboard/${serverData.id}/administration/admins`) { %>
            <%- include('../partials/admin-sudo.ejs') %>
			<a class="is-active" href="#" data-tooltip="Admins">
				<span class="icon"><i class="fa fa-user-secret"></i></span>
				<span>Admins</span>
			</a>
			<% } else { %>
				<a href="/dashboard/<%= serverData.id %>/administration/admins" data-tooltip="Admins">
					<span class="icon"><i class="fa fa-user-secret"></i></span>
					<span>Admins</span>
				</a>
			<% } %>
			<% if ([`/dashboard/${serverData.id}/administration/moderation`, `/dashboard/${serverData.id}/administration/blocked`, `/dashboard/${serverData.id}/administration/muted`, `/dashboard/${serverData.id}/administration/strikes`, `/dashboard/${serverData.id}/administration/status-messages`, `/dashboard/${serverData.id}/administration/filters`].includes(currentPage)) { %>
            <%- include('../partials/admin-sudo.ejs') %>
			<a class="<%= ([`/dashboard/${serverData.id}/administration/moderation`, `/dashboard/${serverData.id}/administration/blocked`, `/dashboard/${serverData.id}/administration/muted`, `/dashboard/${serverData.id}/administration/strikes`, `/dashboard/${serverData.id}/administration/status-messages`, `/dashboard/${serverData.id}/administration/filters`].includes(currentPage) || currentPage === `/dashboard/${serverData.id}/administration/moderation`) ? 'is-active' : '' %>" href="<%= currentPage === `/dashboard/${serverData.id}/administration/moderation` ? '#' : (`/dashboard/${serverData.id}/administration/moderation`) %>" data-tooltip="Moderation">
				<span class="icon"><i class="fa fa-gavel"></i></span>
				<span>Moderation</span>
			</a>
				<ul>
					<li>
						<% if (currentPage === `/dashboard/${serverData.id}/administration/blocked`) { %>
							<a class="is-active" href="#" data-tooltip="Blocked">
								<span class="icon"><i class="fa fa-ban"></i></span>
								<span>Blocked</span>
							</a>
						<% } else { %>
							<a href="/dashboard/<%= serverData.id %>/administration/blocked" data-tooltip="Blocked">
								<span class="icon"><i class="fa fa-ban"></i></span>
								<span>Blocked</span>
							</a>
						<% } %>
					</li>
					<li>
						<% if (currentPage === `/dashboard/${serverData.id}/administration/muted`) { %>
							<a class="is-active" href="#" data-tooltip="Muted">
								<span class="icon"><i class="fa fa-microphone-slash"></i></span>
								<span>Muted</span>
							</a>
						<% } else { %>
							<a href="/dashboard/<%= serverData.id %>/administration/muted" data-tooltip="Muted">
								<span class="icon"><i class="fa fa-microphone-slash"></i></span>
								<span>Muted</span>
							</a>
						<% } %>
					</li>
					<li>
						<% if (currentPage === `/dashboard/${serverData.id}/administration/strikes`) { %>
							<a class="is-active" href="#" data-tooltip="Strikes">
								<span class="icon"><i class="fa fa-exclamation-triangle"></i></span>
								<span>Strikes</span>
							</a>
						<% } else { %>
							<a href="/dashboard/<%= serverData.id %>/administration/strikes" data-tooltip="Strikes">
								<span class="icon"><i class="fa fa-exclamation-triangle"></i></span>
								<span>Strikes</span>
							</a>
						<% } %>
					</li>
					<li>
						<% if (currentPage === `/dashboard/${serverData.id}/administration/status-messages`) { %>
							<a class="moderation-only-menu-item is-active<%= configData.moderation.isEnabled ? "" : " is-hidden" %>" href="#" data-tooltip="Status Messages">
								<span class="icon"><i class="fa fa-commenting"></i></span>
								<span>Status Messages</span>
							</a>
						<% } else { %>
							<a class="moderation-only-menu-item<%= configData.moderation.isEnabled ? "" : " is-hidden" %>" href="/dashboard/<%= serverData.id %>/administration/status-messages" data-tooltip="Status Messages">
								<span class="icon"><i class="fa fa-commenting"></i></span>
								<span>Status Messages</span>
							</a>
						<% } %>
					</li>
					<li>
						<% if (currentPage === `/dashboard/${serverData.id}/administration/filters`) { %>
							<a class="moderation-only-menu-item is-active<%= configData.moderation.isEnabled ? "" : " is-hidden" %>" href="#" data-tooltip="Filters">
								<span class="icon"><i class="fa fa-filter"></i></span>
								<span>Filters</span>
							</a>
						<% } else { %>
							<a class="moderation-only-menu-item<%= configData.moderation.isEnabled ? "" : " is-hidden" %>" href="/dashboard/<%= serverData.id %>/administration/filters" data-tooltip="Filters">
								<span class="icon"><i class="fa fa-filter"></i></span>
								<span>Filters</span>
							</a>
						<% } %>
					</li>
				</ul>
			<% } else { %>
				<a href="/dashboard/<%= serverData.id %>/administration/moderation" data-tooltip="Moderation">
					<span class="icon"><i class="fa fa-gavel"></i></span>
					<span>Moderation &#9662;</span>
				</a>
			<% } %>
			<% if (currentPage === `/dashboard/${serverData.id}/administration/message-of-the-day`) { %>
            <%- include('../partials/admin-sudo.ejs') %>
			<a class="is-active" href="#" data-tooltip="Message of the Day">
				<span class="icon"><i class="fa fa-bullhorn"></i></span>
				<span>Message of the Day</span>
			</a>
			<% } else { %>
				<a href="/dashboard/<%= serverData.id %>/administration/message-of-the-day" data-tooltip="Message of the Day">
					<span class="icon"><i class="fa fa-bullhorn"></i></span>
					<span>Message of the Day</span>
				</a>
			<% } %>
			<% if (currentPage === `/dashboard/${serverData.id}/administration/voicetext-channels`) { %>
            <%- include('../partials/admin-sudo.ejs') %>
			<a class="is-active" href="#" data-tooltip="Voicetext Channels">
				<span class="icon"><i class="fa fa-microphone"></i></span>
				<span>Voicetext Channels</span>
			</a>
			<% } else { %>
				<a href="/dashboard/<%= serverData.id %>/administration/voicetext-channels" data-tooltip="Voicetext Channels">
					<span class="icon"><i class="fa fa-microphone"></i></span>
					<span>Voicetext Channels</span>
				</a>
			<% } %>
			<% if (currentPage === `/dashboard/${serverData.id}/administration/roles`) { %>
            <%- include('../partials/admin-sudo.ejs') %>
			<a class="is-active" href="#" data-tooltip="Roles">
				<span class="icon"><i class="fa fa-id-badge"></i></span>
				<span>Roles</span>
			</a>
			<% } else { %>
				<a href="/dashboard/<%= serverData.id %>/administration/roles" data-tooltip="Roles">
					<span class="icon"><i class="fa fa-id-badge"></i></span>
					<span>Roles</span>
				</a>
			<% } %>
			<% if (currentPage === `/dashboard/${serverData.id}/administration/logs`) { %>
            <%- include('../partials/admin-sudo.ejs') %>
			<a class="is-active" href="#" data-tooltip="Logs">
				<span class="icon"><i class="fa fa-history"></i></span>
				<span>Logs</span>
			</a>
			<% } else { %>
				<a href="/dashboard/<%= serverData.id %>/administration/logs" data-tooltip="Logs">
					<span class="icon"><i class="fa fa-history"></i></span>
					<span>Logs</span>
				</a>
			<% } %>
		</li>
	</ul>
	<p class="menu-label" data-tooltip="AI Assistant">
        <span class="icon is-small">
            <i class="fa fa-robot"></i>
        </span>
        <span>AI Assistant</span>
	</p>
	<ul class="menu-list">
		<li>
			<% if (currentPage === `/dashboard/${serverData.id}/ai/settings`) { %>
            <%- include('../partials/admin-sudo.ejs') %>
			<a class="is-active" href="#" data-tooltip="AI Settings">
				<span class="icon"><i class="fa fa-cogs"></i></span>
				<span>AI Settings</span>
			</a>
			<% } else { %>
				<a href="/dashboard/<%= serverData.id %>/ai/settings" data-tooltip="AI Settings">
					<span class="icon"><i class="fa fa-cogs"></i></span>
					<span>AI Settings</span>
				</a>
			<% } %>
			<% if (currentPage === `/dashboard/${serverData.id}/ai/governance`) { %>
            <%- include('../partials/admin-sudo.ejs') %>
			<a class="is-active" href="#" data-tooltip="Governance & Usage">
				<span class="icon"><i class="fa fa-balance-scale"></i></span>
				<span>Governance & Usage</span>
			</a>
			<% } else { %>
				<a href="/dashboard/<%= serverData.id %>/ai/governance" data-tooltip="Governance & Usage">
					<span class="icon"><i class="fa fa-balance-scale"></i></span>
					<span>Governance & Usage</span>
				</a>
			<% } %>
			<% if (currentPage === `/dashboard/${serverData.id}/ai/memory`) { %>
            <%- include('../partials/admin-sudo.ejs') %>
			<a class="is-active" href="#" data-tooltip="Vector Memory">
				<span class="icon"><i class="fa fa-database"></i></span>
				<span>Vector Memory</span>
			</a>
			<% } else { %>
				<a href="/dashboard/<%= serverData.id %>/ai/memory" data-tooltip="Vector Memory">
					<span class="icon"><i class="fa fa-database"></i></span>
					<span>Vector Memory</span>
				</a>
			<% } %>
			<% if (currentPage === `/dashboard/${serverData.id}/ai/personality`) { %>
            <%- include('../partials/admin-sudo.ejs') %>
			<a class="is-active" href="#" data-tooltip="AI Personality">
				<span class="icon"><i class="fa fa-smile-o"></i></span>
				<span>AI Personality</span>
			</a>
			<% } else { %>
				<a href="/dashboard/<%= serverData.id %>/ai/personality" data-tooltip="AI Personality">
					<span class="icon"><i class="fa fa-smile-o"></i></span>
					<span>AI Personality</span>
				</a>
			<% } %>
            <% if (currentPage === `/dashboard/${serverData.id}/ai/models`) { %>
            <%- include('../partials/admin-sudo.ejs') %>
            <a class="is-active" href="#" data-tooltip="AI Models">
                <span class="icon"><i class="fa fa-cube"></i></span>
                <span>AI Models</span>
            </a>
            <% } else { %>
                <a href="/dashboard/<%= serverData.id %>/ai/models" data-tooltip="AI Models">
                    <span class="icon"><i class="fa fa-cube"></i></span>
                    <span>AI Models</span>
                </a>
            <% } %>
		</li>
	</ul>
</aside>

<script>
    $(document).ready(function() {
        // Restore sidebar state from localStorage
        if (localStorage.getItem('sidebarCollapsed') === 'true') {
            $('body').addClass('sidebar-collapsed');
            $('#menu').addClass('is-collapsed');
        } else {
            $('body').removeClass('sidebar-collapsed');
            $('#menu').removeClass('is-collapsed');
        }

        // Toggle handler
        $('#sidebar-toggle').click(function(e) {
            e.preventDefault();
            e.stopPropagation();
            
            $('body').toggleClass('sidebar-collapsed');
            $('#menu').toggleClass('is-collapsed');
            
            // Save state
            localStorage.setItem('sidebarCollapsed', $('body').hasClass('sidebar-collapsed'));
        });
    });
</script>